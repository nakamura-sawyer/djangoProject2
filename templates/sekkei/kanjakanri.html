<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>患者管理</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        $(document).ready(function() {
            $('#patid').on('change', function() {
                var patid = $(this).val();
                if (patid) {
                    $.ajax({
                        url: '{% url "get_hoken_details" %}',  // 保険証番号を取得するURL
                        type: 'GET',
                        data: {
                            'patid': patid
                        },
                        success: function(data) {
                            if (data.success) {
                                $('#hokenmei').val(data.hokenmei);
                                $('#hokenexp').val(data.hokenexp);
                            } else {
                                alert('患者IDが見つかりません');
                            }
                        }
                    });
                }
            });
        });
    </script>
</head>
<body>
<h1>患者管理</h1>
<form action="{% url 'update_hoken' %}" method="post">
    {% csrf_token %}
    <label for="patid">患者ID:</label>
    <input type="text" id="patid" name="patid" required><br><br>

    <label for="hokenmei">保険証番号:</label>
    <input type="text" id="hokenmei" name="hokenmei" required><br><br>

    <label for="hokenexp">有効期限:</label>
    <input type="date" id="hokenexp" name="hokenexp" required><br><br>

    <input type="submit" value="変更">
</form>
<a href="{% url 'home_uketuke' %}">
<p>戻る</p></a>
</body>
</html>